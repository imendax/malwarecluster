#!/usr/bin/python3

import networkx
from networkx.drawing.nx_pydot import write_dot

from relationships import formrelations

#def network(malwarepaths, threshold, similaritymeasure, outputdotfile):
def network(malwarepaths, nethreshold, ethreshold, ngram, outputdotfile):
    """
    Display malware relationships based on printable strings feature set for
    non-exe and dynamic API calls for exe malware samples

    Args:
        malwarepaths : absolute path of all malware samples
        nethreshold  : jaccard index similarity threshold for non exe samples
        ethreshold   : jaccard index similarity threshold for exe samples
        ngram        : ngram api sequence
        outputdotfile: name of output dot file

    Raises:
    Returns:
        None
    """

    # Initialize graph
    graph = networkx.Graph()

    # Create relations for non-exe and exe malware samples
    graph = formrelations(malwarepaths, nethreshold, ethreshold, ngram, graph)

    # write networkx graph object to disk as DOT file
    write_dot(graph, outputdotfile)
