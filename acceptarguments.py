#!/usr/bin/python3

import sys
import argparse

def parseargs():
    parser = argparse.ArgumentParser(
        description="""
                    Malware network builder and searcher.
                    """
    )

    parser.add_argument(
        "--malwaredir", "-d", dest="malwaredir", required=True,
        help="Path to directory containing malware, or individual malware file to analyze / store"
    )

    parser.add_argument(
        "--load", "-l", dest="load", action="store_true", default=False,
        help="Malware features are to be extracted, loaded into samples.db and analyzed in cuckoo"
    )

    parser.add_argument(
        "--network", "-n", dest="network", action="store_true", default=False,
        help="Malware features are to be used to create a malware network graph"
    )

    parser.add_argument(
        "--wipe", "-w", dest="wipe", action="store_true", default=False,
        help="Wipe malware network database file, samples.db"
    )

    parser.add_argument(
        "--outputdotfile", dest="outputdotfile", type=str, default="network.dot",
        help="Where to save the output graph DOT file"
    )

    parser.add_argument(
        "--nonexejaccardthreshold", "-nej", dest="nethreshold", type=float,
        default=0.8, help="Threshold above which to create an 'edge' between non-exe samples"
    )

    parser.add_argument(
        "--exejaccardthreshold", "-ej", dest="ethreshold", type=float,
        default=0.8, help="Threshold above which to create an 'edge' between exe samples"
    )

    parser.add_argument(
        "--ngram", "-ng", dest="ngram", type=int, default=3,
        help="ngram API sequence"
    )

    args = parser.parse_args()

    if len(sys.argv) == 1:
        parser.print_help()

    return args
